<!DOCTYPE html>
{% load staticfiles %}

<html>


<head>

  <title>O2 UK - Fusion PE Portal</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script async src="{% static "/static/ei.js" %}"></script>
  <script src="{% static "/static/jquery-1.11.3.min.js" %}"></script>
    
  <link rel="stylesheet" href="{% static '/static/w3.css' %}">  
  <link rel="stylesheet" href="{% static '/static/CascadedStyle.css' %}" type="text/css">

  <script src="{% static "/static/bootstrap.min.js" %}"></script>
  <link href="{% static "/static/bootstrap.min.css" %}" rel="stylesheet">
  <script src="{% static '/static/ipaddr.js' %}"></script>

</head>


{% include 'session_security/all.html' %}


<script type="text/javascript">

function updateClock (){
  
  var currentTime = new Date ( );
 
  //Get the hours for updating clock
  var currentHours = currentTime.getHours ();
 
  //Get the minuts for updating clock
  var currentMinutes = currentTime.getMinutes ();
 
  //Get the secconds for updating clock
  var currentSeconds = currentTime.getSeconds ();
 
  // Pad the minutes and seconds with leading zeros, if required
  currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
  currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;
 
  // Choose either "AM" or "PM" as appropriate
  var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";
 
  // Convert the hours component to 12-hour format if needed
  currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;
 
  // Convert an hours component of "0" to "12"
  currentHours = ( currentHours == 0 ) ? 12 : currentHours;
 
  // Compose the string for display
  var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;
 
  // Update the time display
  document.getElementById("clock").firstChild.nodeValue = currentTimeString;
}
</script>
 
 
 
 
 
<script type="text/javascript">


    var LockPage = 0;

    //var ipaddr = require('/static/ipaddr.js');

    function BlockScreen () {

        var elems = document.getElementsByTagName('input');
        var len = elems.length;

            for (var i = 0; i < len; i++) {
                elems[i].disabled = true;
            }
        
        var elemsSelect = document.getElementsByTagName('select');
        var lenSelect = elemsSelect.length;

            for (var i = 0; i < lenSelect; i++){
                elemsSelect[i].disabled = true;
            }

        var elemsButton = document.getElementsByTagName('button');
        var lenButton = elemsButton.length;
            for (var i = 0; i < lenButton; i++) {
            elemsButton[i].disabled = true;
            }

    }


    function UnBlockScreen () {

        var elems = document.getElementsByTagName('input');
        var len = elems.length;

            for (var i = 0; i < len; i++) {
                elems[i].disabled = false;
            }
        
        var elemsSelect = document.getElementsByTagName('select');
        var lenSelect = elemsSelect.length;

            for (var i = 0; i < lenSelect; i++){
                elemsSelect[i].disabled = false;
            }

        var elemsButton = document.getElementsByTagName('button');
        var lenButton = elemsButton.length;
            for (var i = 0; i < lenButton; i++) {
                elemsButton[i].disabled = false;
            }

    }


    function removeOptions(selectbox) {
 
    var i;
        for(i=selectbox.options.length-1;i>=0;i--) {
            selectbox.remove(i);
        }
    }

    function RemoveDots(which, event) {

    var kc;

        if (window.event)
            kc = event.keyCode;
        else
            kc = e.keyCode;


        if ((kc == 110) || (kc == 46)) {

            alert("This number can only be integer.");

            document.getElementById(which).focus();
            return false;
            
            }
    }


    function GetICCFirewalls(){       
    
        removeOptions(document.getElementById("FW_ID"));
        removeOptions(document.getElementById("FW_ID_Policy"));
        removeOptions(document.getElementById("FW_ID_Interface"));
        removeOptions(document.getElementById("FW_ID_DHCP"));
        removeOptions(document.getElementById("FW_ID_StaticRoute"));

        $.ajax({
            type: "GET",
            url: '/php/COLLECT_ICC_FWs.php',
            dataType: "text",

            success: function (data) {
             
                var res = data.split(" ");
            
                $.each(res, function(key, value) {   
                $('#FW_ID')
                .append($("<option></option>")
                .attr("value",key)
                .text(value)); 

                $('#FW_ID_Policy')
                .append($("<option></option>")
                .attr("value",key)
                .text(value)); 

                $('#FW_ID_Interface')
                .append($("<option></option>")
                .attr("value",key)
                .text(value)); 

                $('#FW_ID_DHCP')
                .append($("<option></option>")
                .attr("value",key)
                .text(value));                 

                $('#FW_ID_StaticRoute')
                .append($("<option></option>")
                .attr("value",key)
                .text(value));  

                });

            }
        });
      
    }


    function OnStartPopulateRename(){

        $.ajax({
            url: '/php/OnStartPopulateRename.php',
            type: 'POST',
            dataType: "text",
            success: function(response) {

                result_from_PHP = response;
                document.getElementById("Rename_Device_Table").innerHTML = result_from_PHP;

                var tables, lastRow, row, newCell, colValues;
                colValues = ['first cell','cell 2','another cell'];

                tables = document.getElementById("Rename_Device_Table");
                lastRow = document.getElementById("Rename_Device_Table").rows.length;


                for (var i = 1; i < lastRow; i++) {
             
                    row = tables.rows[i];
                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='text' size='40px' style='margin: 5px' id='New_FW_Name_"+ i +"' name='New_FW_Name_"+ i+"'/>";  
                                                            
                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='New_FW_Name_"+ i +"' id='Rename_This_FW_ID_"+ i +"' name='FW_To_Rename'/>";
                                                                 
                }

                ApplyRenamingTableCSS();
            }
        });
    }


    function HideSwapTerms(){

        $('#SwapPolicyTerms').hide();

    }


    function applyCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(1) ").css("text-align", "center");     
        $("table#StatusTable td:nth-child(2) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(2) ").css("text-align", "center");   
        $("table#StatusTable td:nth-child(3) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(3) ").css("text-align", "center");
        $("table#StatusTable td:nth-child(4) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(4) ").css("text-align", "left");

        $("table#StatusTable td").css("text-indent", "5px");

        $("table#StatusTable td:nth-child(6) ").css("background-color", "#FFF");
        $("table#StatusTable td:nth-child(6) ").css("border","1px solid #FFF");

        $("table#StatusTable td:nth-child(5) ").css("text-align", "center");
        $("table#StatusTable td:nth-child(5) ").css("border","1px solid #000");

        $("table#StatusTable td:nth-child(4) ").css("padding-left", "20px");

        UnBlockScreen();

        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);
        
        $("table#StatusTable th").css("text-align", "center");

    }

    function applyRoutingTableCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "250px");      
        $("table#StatusTable td:nth-child(2) ").css("width", "250px");    
        $("table#StatusTable td:nth-child(3) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "250px"); 

        $("table#StatusTable td:nth-child(6) ").css("background-color", "#FFF");
        $("table#StatusTable td:nth-child(6) ").css("border","1px solid #FFF");

        $("table#StatusTable td:nth-child(5) ").css("border","1px solid #000");        

        $("#StatusTable th").css("text-align", "center");

        $("table#StatusTable td").css("text-indent", "5px");
        $("table#StatusTable td").css("text-align", "center");
        
        UnBlockScreen();

        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }

    function applyFWSessionsCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "250px");      
        $("table#StatusTable td:nth-child(2) ").css("width", "170px");    
        $("table#StatusTable td:nth-child(3) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "170px"); 
        $("table#StatusTable td:nth-child(5) ").css("width", "170px"); 
        $("table#StatusTable td:nth-child(6) ").css("width", "170px");

        $("table#StatusTable td").css("text-indent", "5px");
        $("table#StatusTable td").css("text-align", "center");

        UnBlockScreen();
                
        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }


    function applyUniqueFWSessionsCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "15%");      
        $("table#StatusTable td:nth-child(2) ").css("width", "15%");    
        $("table#StatusTable td:nth-child(3) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(5) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(6) ").css("width", "30%");

        $("table#StatusTable td").css("text-indent", "5px");
        $("table#StatusTable td").css("text-align", "center");

        UnBlockScreen();
                
        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }


    function applyPoliciesCSS(){ 

        $("table#SwapPolicyTerms").css("width", "300px");

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "240px");      
        $("table#StatusTable td:nth-child(2) ").css("width", "165px");    
        $("table#StatusTable td:nth-child(3) ").css("width", "165px"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "150px"); 

        $("table#StatusTable td:nth-child(5) ").css("width", "200px"); 
        
        $("table#StatusTable td:nth-child(6) ").css("width", "150px"); 
        $("table#StatusTable td:nth-child(7) ").css("width", "150px"); 

        $("table#StatusTable td").css("text-indent", "5px");

        $("table#StatusTable td").css("text-align", "center");
        
        UnBlockScreen();

        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }


    function Printer(){
       
        var SessionsStatus = 1;
     
        $.ajax({
            url: '/php/FWSessionsPrinter.php',
            type: 'POST',
            dataType: "text",
            data : {SessionsStatus : SessionsStatus},
            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;
                applyFWSessionsCSS();
                },
            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }
 
    function LoadDoc() {

        $('#preloader').show();
        var result_from_function;
       
        $.ajax({
            url: 'sessions/',
            type: 'GET',
            dataType: "text",
            success: function(response) {
            result_from_function = response;

            if (result_from_function = "SessionsCollected"){
                Printer();
                }
            else {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );

            }
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }
     
 
 
    function GetInterfaces(){
     
        var result_from_vSRX;
       
        $.ajax({
            url: 'interfaces/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
            result_from_vSRX = response;
            InterfacesPHP(result_from_vSRX);
            },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }
     
 

    function InterfacesPHP(result_from_function){
       
        var result_from_function = result_from_function;
     
        $.ajax({
           url: '/php/IPsAndZones.php',
            type: 'POST',
            dataType: "text",
            data : {Input_From_Python : result_from_function},
            success: function(response) {
                result_from_PHP = response;
                document.getElementById("InterfacesTable").innerHTML = result_from_PHP;
            }
        });
    }
 
 

    function Printer_Routes() {   

        var Splitted = 1;

        $.ajax({
            url: '/php/Routing_Table.php',
            type: 'POST',
            dataType: "text",
            data : {Input_From_Python : Splitted},

            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;

                tables = document.getElementById("StatusTable");
                lastRow = document.getElementById("StatusTable").rows.length;

                for (var i = 1; i < lastRow; i++) {                         
                 
                    Row_Index = i;
                    Column_Index = 3;

                    var table = document.getElementById("StatusTable");
                    var StaticRoutePointer = table.rows[Row_Index].cells[Column_Index].innerHTML;
                    StaticRoutePointer = StaticRoutePointer.trim();

                    if (StaticRoutePointer == "Static") {

                    row = table.rows[i];

                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='Static_Route_To_Delete_"+ i +"' id='Static_Route_To_Delete_"+ i +"' name='Static_Route_To_Delete'/>";

                   }

                    if (StaticRoutePointer !== "Static") {

                    row = table.rows[i];

                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "N/A";

                   }

                }

                row = tables.rows[1];
                newCell = row.insertCell(row.cells.length);
                newCell.innerHTML = "<button type='button' onclick='DeleteSelectedRoute()'>Delete Route</button>";
                                         
                applyRoutingTableCSS();
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }   
    
 


    function LoadDoc_Routes() {

        $('#preloader').show();
        var result_from_function;
       
        $.ajax({
            url: 'routes/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
                result_from_function = response;

                if (result_from_function === "RoutesCollected"){
                //Printer_Routes(result_from_function);
                Printer_Routes();
                }
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });

        
    }


        var InitialValue = 0;
        var source;
        var source_mask;
        var destination;
        var destination_mask;
        var Source_IP_Address;
        var Source_Mask;
        var Dest_IP_Address;
        var Dest_Mask;
  
        var policy;
        var port;
        var protocol;
 
 
 
        var Source_IP_Address = InitialValue;
        var Source_Mask = InitialValue;
        var Dest_IP_Address = InitialValue;
        var Dest_Mask = InitialValue;
 
        function changeTab(which, event) {
 
            var kc;
 
            if (window.event)
                kc = event.keyCode;
            else
                kc = e.keyCode;
 
 
            if ((kc == 110) || (kc == 46)) {
 
                var idval = document.getElementById(which).id;
                var ipvalue = document.getElementById(idval).value.toString();
 
                document.getElementById(idval).value = ipvalue.substring(0, ipvalue.length);
 
                var idpos = parseInt(idval.substring(idval.length - 1, idval.length));
                idpos++;
                idpos %= 4;
 
                var nextid = "";
 
 
                if ((which == "ip") || (which == "ip1") || (which == "ip2") || (which == "ip3") || (which == "ip4")) {
 
                if (idpos == 0) {
                    nextid = "ip4";
                }
                else
                    nextid = "ip" + idpos;
 
                }
 
 
                if ((which == "ipd") || (which == "ipd1") || (which == "ipd2") || (which == "ipd3") || (which == "ipd4")) {
 
                if (idpos == 0) {
                    nextid = "ipd4";
                }
                else
                    nextid = "ipd" + idpos;
 
                }

                
                if ((which == "INTip") || (which == "INTip1") || (which == "INTip2") || (which == "INTip3") || (which == "INTip4")) {
 
                if (idpos == 0) {
                    nextid = "INTip4";
                }
                else
                    nextid = "INTip" + idpos;
 
                }



                if ((which == "ipDHCP_Pool") || (which == "ipDHCP_Pool1") || (which == "ipDHCP_Pool2") || (which == "ipDHCP_Pool3") || (which == "ipDHCP_Pool4")) {
 
                if (idpos == 0) {
                    nextid = "ipDHCP_Pool4";
                }
                else
                    nextid = "ipDHCP_Pool" + idpos;
 
                }

                if ((which == "ipDHCP_First") || (which == "ipDHCP_First1") || (which == "ipDHCP_First2") || (which == "ipDHCP_First3") || (which == "ipDHCP_First4")) {
 
                if (idpos == 0) {
                    nextid = "ipDHCP_First4";
                }
                else
                    nextid = "ipDHCP_First" + idpos;
 
                }

                if ((which == "ipDHCP_Last") || (which == "ipDHCP_Last1") || (which == "ipDHCP_Last2") || (which == "ipDHCP_Last3") || (which == "ipDHCP_Last4")) {
 
                if (idpos == 0) {
                    nextid = "ipDHCP_Last4";
                }
                else
                    nextid = "ipDHCP_Last" + idpos;
 
                }

                if ((which == "ipDHCP_DG") || (which == "ipDHCP_DG1") || (which == "ipDHCP_DG2") || (which == "ipDHCP_DG3") || (which == "ipDHCP_DG4")) {
 
                if (idpos == 0) {
                    nextid = "ipDHCP_DG4";
                }
                else
                    nextid = "ipDHCP_DG" + idpos;
 
                }

                if ((which == "ipDHCP_DNS") || (which == "ipDHCP_DNS1") || (which == "ipDHCP_DNS2") || (which == "ipDHCP_DNS3") || (which == "ipDHCP_DNS4")) {
 
                if (idpos == 0) {
                    nextid = "ipDHCP_DNS4";
                }
                else
                    nextid = "ipDHCP_DNS" + idpos;
 
                }

                if ((which == "FWSessionSource") || (which == "FWSessionSource1") || (which == "FWSessionSource2") || (which == "FWSessionSource3") || (which == "FWSessionSource4")) {
 
                if (idpos == 0) {
                    nextid = "FWSessionSource4";
                }
                else
                    nextid = "FWSessionSource" + idpos;
 
                }

                if ((which == "FWSessionDestination") || (which == "FWSessionDestination1") || (which == "FWSessionDestination2") || (which == "FWSessionDestination3") || (which == "FWSessionDestination4")) {
 
                if (idpos == 0) {
                    nextid = "FWSessionDestination4";
                }
                else
                    nextid = "FWSessionDestination" + idpos;
 
                }

                if ((which == "ipStaticRouteSubnet") || (which == "ipStaticRouteSubnet1") || (which == "ipStaticRouteSubnet2") || (which == "ipStaticRouteSubnet3") || (which == "ipStaticRouteSubnet4")) {
 
                if (idpos == 0) {
                    nextid = "ipStaticRouteSubnet4";
                }
                else
                    nextid = "ipStaticRouteSubnet" + idpos;
 
                }

                if ((which == "ipStaticRouteNextHop") || (which == "ipStaticRouteNextHop1") || (which == "ipStaticRouteNextHop2") || (which == "ipStaticRouteNextHop3") || (which == "ipStaticRouteNextHop4")) {
 
                if (idpos == 0) {
                    nextid = "ipStaticRouteNextHop4";
                }
                else
                    nextid = "ipStaticRouteNextHop" + idpos;
 
                }
 
                document.getElementById(nextid).focus();
                return false;
            }
        }



    function validate_IP(ID) {
       
        var IpId = ID;
        var IsNumber;
        var ip_address = "";
        var Error = "Error";

        for (var i = 1; i <= 4; i++) {

            IpId += i;          
            
            var ipValue = document.getElementById(IpId).value;

            if (isNaN(ipValue) || !ipValue) {
                alert("Enter a valid IP value");
                document.getElementById(IpId).focus();
                return Error;                
            }

            if (ipValue < 0 || ipValue > 255) {

                $('#preloader').hide();
                alert("Enter a valid IP value");
                document.getElementById(IpId).focus();
                return Error;
            }

            IpId = ID;
           
            if (i==1) {ip_address = ipValue;}
         
            else {ip_address = ip_address + "." + ipValue;}
        }

        return(ip_address);

    }


    function validateMASK(masktotest){

            var mask = masktotest;
            var Error = "Error";

            var NumberTest = document.getElementById(mask).value;

            if (isNaN(NumberTest) || !NumberTest) {
                $('#preloader').hide();
                alert("Enter a valid Prefix.");
                document.getElementById(mask).focus();
                return Error;                
            }

            if (NumberTest < 0 || NumberTest > 32) {
                $('#preloader').hide();
                alert("Enter a valid Prefix.");
                document.getElementById(mask).focus();
                return Error;
            }
                else {
                mask = NumberTest;
                }

        return mask;
    }
 

    function validateDHCHPPoolMASK(masktotest){
                 
            var mask = masktotest;
            var Error = "Error";

            var NumberTest = document.getElementById(mask).value;

            if (isNaN(NumberTest) || !NumberTest) {
                $('#preloader').hide();
                alert("Enter a valid Prefix.");
                document.getElementById(mask).focus();
                return Error;                
            }

            if (NumberTest < 8 || NumberTest > 29) {
                $('#preloader').hide();
                alert("Enter a valid Prefix.");
                document.getElementById(mask).focus();
                return Error;
            }
                else {
                mask = NumberTest;
                }

        return mask;
    }


    function validatePORT(PortToTest){
           
            var Port = PortToTest;
            var Error = "Error";
            var validated_Port;

            var NumberTest = document.getElementById(Port).value;

            if (isNaN(NumberTest) || !NumberTest) {
                $('#preloader').hide();
                alert("Enter a valid Port.");
                document.getElementById(Port).focus();
                return Error;                
            }

            if (NumberTest < 1 || NumberTest > 65535) {
                $('#preloader').hide();
                alert("Enter a valid Port.");
                document.getElementById(Port).focus();
                return Error;
            }
                else {
                validated_Port = NumberTest;
                }

        return validated_Port;
    }


    function validate_VLAN(VLAN) {

            var VLANtoTest = VLAN;
            var Error = "Error";
            var validated_VLAN;

            var NumberTest = document.getElementById(VLANtoTest).value;

            if (isNaN(NumberTest) || !NumberTest) {
                alert("Enter a valid VLAN number.");
                document.getElementById(VLANtoTest).focus();
                return Error;                
            }

            if (NumberTest < 2 || NumberTest > 1000) {

                $('#preloader').hide();
                alert("Enter a valid VLAN number.");
                document.getElementById(VLANtoTest).focus();
                return Error;
            }
                else {
                validated_VLAN = NumberTest;
                }

        return validated_VLAN;
    }



  
    function CreatePolicy() {
        
        $('#preloader').show();      

        BlockScreen();

        var LastPolicyPort = 0;
        var FirstPolicyPort = 0;        
        var ProtocolCheckedTest = 0;
        var AnySpecificOrPortRange = 0;        
        var PolicyActionCheckedTest = 0;        
        var PolicyDirectCheckedTest = 0;

        var PolicyDirection = "choices";
        var PolicyProtocol = "protocolID";
        var RejectPermit = "PolicyAction";
        var WhatTCPorUDPPort = "WhatTCPorUDPPort";


        var Source_IP_Address = validate_IP("ip");
        if ( Source_IP_Address === "Error") {
        UnBlockScreen();
        $('#preloader').hide();    
        return; 
        }

        var Source_Mask = validateMASK("MaskId");
        if (Source_Mask === "Error") {
        UnBlockScreen();
        $('#preloader').hide(); 
        return; 
        }

        var Dest_IP_Address = validate_IP("ipd");
        if  (Dest_IP_Address === "Error") {
        UnBlockScreen();
        $('#preloader').hide();     
        return; 
        }

        var Dest_Mask = validateMASK("MaskId_Dest");
        if (Dest_Mask === "Error") {
        UnBlockScreen();
        $('#preloader').hide();   
        return; 
        }


       for (var i = 1; i < 7; i++) {

            var d = PolicyDirection + i;

            if (document.getElementById(d).checked) {

            var policy = document.querySelector('input[name="choices"]:checked').value;
            PolicyDirectCheckedTest = 1;
            }
        }

        if (PolicyDirectCheckedTest == 0) {
            alert ("Please select the Zones pair.");
            UnBlockScreen();
            $('#preloader').hide();  
            return;
        }

        for (var i = 1; i < 6; i++) {

            var d = PolicyProtocol + i;
       
            if (document.getElementById(d).checked) {

            var protocol = document.querySelector('input[name="protocolID"]:checked').value;
            ProtocolCheckedTest = 1;
            }
            
        }

        if (ProtocolCheckedTest == 0) {
            alert ("Please select Layer 4 protocol or ICMP.");
            UnBlockScreen();
            $('#preloader').hide();  
            return;
        }
 

        if ( (protocol === "ICMP") || (protocol === "ICC_FW_EXTENDED_TIMEOUT") || (protocol ==="ICC_FW_UUID_EXTENSIONS") ){
        var port = "1";
        var PolicyPorts = 0;
        }



        if ( (protocol != "ICMP") && (protocol != "ICC_FW_EXTENDED_TIMEOUT") && (protocol != "ICC_FW_UUID_EXTENSIONS") ){

            for (var i = 1; i < 4; i++) {

                var p = WhatTCPorUDPPort + i;

                if (document.getElementById(p).checked) {

                    var PolicyPorts = document.querySelector('input[name="PolicyPortsCh"]:checked').value;
                    AnySpecificOrPortRange = 1;
                    }

            }

            if (AnySpecificOrPortRange == 0) {
                alert ("Please select policy port.");
                UnBlockScreen();
                $('#preloader').hide();  
                return;
                }

            if (PolicyPorts === "any" ) {

                var port = "any"; 
            }

            if (PolicyPorts === "Specific") {

                var port = validatePORT("portId");

                if (port === "Error") {
                    UnBlockScreen();
                    $('#preloader').hide();     
                    return; 
                }
            }


            if (PolicyPorts === "Range") {

            port = validatePORT("PortRangeid1");

                 if (port === "Error") {
                    UnBlockScreen();
                    $('#preloader').hide();     
                    return; 
                }       

            LastPolicyPort = validatePORT("PortRangeid2");

                 if (LastPolicyPort === "Error") {
                    UnBlockScreen();
                    $('#preloader').hide();     
                    return; 
                }   

                if ( LastPolicyPort <= port ) {
                    UnBlockScreen();
                    $('#preloader').hide(); 
                    alert ("First port in port range must be lower than last.");
                    return;
                }
     
            }


        }


       for (var i = 1; i < 3; i++) {

            var d = RejectPermit + i;

            if (document.getElementById(d).checked) {

            var Action = document.querySelector('input[name="PolicyAction"]:checked').value;
            PolicyActionCheckedTest = 1;
            }
        }

        if (PolicyActionCheckedTest == 0) {
            UnBlockScreen();
            $('#preloader').hide(); 
            alert ("Please select Policy action.");
            return;
        }
         
 
        var Required_FW_Index = document.getElementById("FW_ID_Policy").selectedIndex;
    
            if (Required_FW_Index === 0 ) {
                UnBlockScreen();
                alert("Please select Fusion PE.");
                $('#preloader').hide(); 
                return;
            }

        var Required_FW = document.getElementById("FW_ID_Policy").options[Required_FW_Index].text;

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW},
    
                success: function(response) {
                result_from_PHP = response;
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
                               
 
            $.ajax({
                  url: '/php/Create_Policy.php',
                  type: 'POST',
                  dataType: "text",
                  data : {source: Source_IP_Address, destination: Dest_IP_Address,
                            Source_Mask: Source_Mask, Dest_Mask: Dest_Mask,
                                policy: policy, PolicyPorts: PolicyPorts,
                                     port: port, LastPolicyPort: LastPolicyPort,
                                        protocol: protocol, 
                                    Action: Action},
                                    
                  success: function(response) {

                        result = response;                

                        if (result == 1) {
                            NewPolicyTerm();

                          //alert ("Done.");
                        }
                        else {
                            alert (result);
                            UnBlockScreen();
                            $('#preloader').hide();
                            return;
                        }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }
 

    function NewPolicyTerm() {
       
        $.ajax({
            url: 'NewPolicyTerm/',
            type: 'GET',
            dataType: "text",
 
            success: function(response) {
                result = response;
                UnBlockScreen();
                $('#preloader').hide();
                alert(result);
                LogChange();
            },


            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                UnBlockScreen();
                console.log(xhr, status);
            }
        });
       
    }


    function UpdatePolicy() {
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            dataType: "text",
            success: function(response) {
                result = response;
                $('#preloader').hide();
                alert(result);
 
            },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
       
    }



    function ApplyPolicy() {
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 300000,
            dataType: "text",
            success: function(response) {
                result = response;
                $('#preloader').hide();
                alert(result);
            },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }
         

    function GetInterfacesIP_Address(){
  
        
        BlockScreen(); 

        var validatedVLAN = validate_VLAN("VLANnumber");
        if (validatedVLAN === "Error") {
        UnBlockScreen();
        return; 
        }

        var IP_Address = validate_IP("INTip");
        if (IP_Address === "Error") {
        UnBlockScreen();
        return; 
        }
        
        var Mask = validateMASK("INTMaskId");   
        if (Mask === "Error") {
        UnBlockScreen();
        return; 
        }

        var ZoneToConfig = document.querySelector('input[name="ZoneID"]:checked').value;

        var Required_FW_Index = document.getElementById("FW_ID_Interface").selectedIndex;
 
        if (Required_FW_Index ==  0 ) {
            alert("Please select Fusion PE.");
            UnBlockScreen();
            return;
        }

     $('#preloader').show(); 

        var Required_FW = document.getElementById("FW_ID_Interface").options[Required_FW_Index].text;

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW}, 
                success: function(response) {
                result_from_PHP = response;
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });

        
        var result_from_vSRX;
   
        $.ajax({
            url: 'intMaskVLAN/',            // Was: url: 'interfaces/',
            type: 'GET',
            dataType: "text",
            timeout: 300000,
            success: function(response) {
                result_from_vSRX = response;
                InterfacesPHP_IP(result_from_vSRX,IP_Address,Mask,ZoneToConfig,validatedVLAN);
            },
            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },
            complete: function( xhr, status ) {
                console.log(xhr, status);
            }
        });
     }


    function InterfacesPHP_IP(result_from_function,IP_Address,Mask,ZoneToConfig,validatedVLAN){

        var Mask = Mask;
        var IP_Address = IP_Address;
        var ZoneToConfig = ZoneToConfig;
        var validatedVLAN = validatedVLAN;
        var result_from_function = result_from_function;
        
        $.ajax({
            url: '/php/findipandvlan.php',
            timeout: 300000,
            type: 'POST',
            dataType: "text",
            data : {IP_Address: IP_Address, Mask: Mask,
                        ZoneToConfig: ZoneToConfig, validatedVLAN: validatedVLAN,
                             result_from_function: result_from_function},
            success: function(response) {
                result = response;

                    if (result == 1) {

                    ApplyIPAddressFunction();

                    }

                    else {
                        alert (result);
                        UnBlockScreen();
                        $('#preloader').hide();
                        return;
                    }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }


    function ApplyIPAddressFunction() {
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 300000,
            dataType: "text",
            success: function(response) {
                result = response;
                $('#preloader').hide();
                UnBlockScreen();
                alert(result);
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();
                UnBlockScreen();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }

    function LogChange() {
       
        $.ajax({
            url: '/php/ConfigLogger.php',
            type: 'GET',
            dataType: "text",
            success: function(response) {
                result = response;
                alert(result);
            },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();
                UnBlockScreen();    
                alert( "There was a problem logging the change." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function CreateDNSEntry() {

    var DNS_Number = parseInt(document.getElementById("HoldZone").value);
    var Error = "Error";

       if (DNS_Number == 0 ) {

                var DNS_Btn = 5;
                var Additional_DNS = "DNS_1_";
            }


            if (DNS_Number == 1 ) {

                var DNS_Btn = 9;
                var Additional_DNS = "DNS_2_";
            }

        for (var i = 1; i <= 4; i++) {

      

            if (DNS_Number == 2 ) {

            alert("Max. DNS server number reached");
            return Error;
            break;
      
            }

            var input = document.createElement("input");
            input.type = "text";


            var ID = document.createElement("id");
            ID.setAttribute("value", i)

            input.setAttribute("id", Additional_DNS + i);
            input.setAttribute("class", "DHCP_DNS");
            DHCP_DNS.appendChild(input);

        }


        linebreak = document.createElement("br");
        linebreak.setAttribute("id", "LINEBREAK");
        DHCP_DNS.appendChild(linebreak);

        DNS_Number ++;

        document.getElementById("HoldZone").value = DNS_Number;


        
        RemoveButton = document.createElement("BUTTON");
        RemoveButton.setAttribute("id", DNS_Btn + "Btn");
        var t = document.createTextNode("REMOVE");
        RemoveButton.appendChild(t);

        DHCP_DNS.appendChild(RemoveButton);
       
        DHCP_DNS.appendChild(linebreak);

        RemoveButton.onclick = function () {
      
            for (var i = 1; i <= 4; i++) {
           
                var d = document.getElementById(Additional_DNS + i );
                d.parentNode.removeChild(d);
            }

            var d = document.getElementById(DNS_Btn + "Btn");
            d.parentNode.removeChild(d);

            var d = document.getElementById("LINEBREAK");
            d.parentNode.removeChild(d);

            var DNS_Number = parseInt(document.getElementById("HoldZone").value);

            DNS_Number = DNS_Number - 1;

            document.getElementById("HoldZone").value = DNS_Number;

        }
              
    }


    function GetInterfacesDHCP(){

        $('#preloader').show();

        BlockScreen();
     
        var validatedVLAN = validate_VLAN("DHCPVLANnumber");
        if (validatedVLAN === "Error") {
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DHCP_Pool_Subnet = validate_IP("ipDHCP_Pool"); 
        if (DHCP_Pool_Subnet === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DHCP_Pool_Mask = validateDHCHPPoolMASK("DHCPMaskId");  
        if (DHCP_Pool_Mask === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var First_DHCP_Addr = validate_IP("ipDHCP_First");  
        if (First_DHCP_Addr === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var Last_DHCP_Addr = validate_IP("ipDHCP_Last"); 
        if (Last_DHCP_Addr === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var Default_GW = validate_IP("ipDHCP_DG");
        if (Default_GW === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DNS_Server = validate_IP("ipDHCP_DNS");
        if (DNS_Server === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }


        var Required_FW_Index = document.getElementById("FW_ID_DHCP").selectedIndex;

            if (Required_FW_Index === 0 ) {
                $('#preloader').hide();
                UnBlockScreen();
                alert("Please select Fusion PE.");
                return;
            }

        var Required_FW = document.getElementById("FW_ID_DHCP").options[Required_FW_Index].text;

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW},

                success: function(response) {
                result_from_PHP = response;
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });

 
        var result_from_vSRX;

            $.ajax({
                url: 'interfaces/',
                type: 'GET',
                dataType: "text",

                success: function(response) {
                    Interfaces_from_vSRX = response;
                    Get_Configuration(Interfaces_from_vSRX);

                },

                error: function( xhr, status, errorThrown ) {
                    UnBlockScreen();
                    $('#preloader').hide();    
                    alert( "There was a problem completing the request." );
                    console.log( "Error: " + errorThrown );
                    console.log( "Status: " + status );
                    console.dir( xhr );
                },

                complete: function( xhr, status ) {
                    $('#preloader').hide(); 
                    console.log(xhr, status);
                }
        });
    }


    function Get_Configuration(Interfaces_from_vSRX){
       
        var Interfaces_from_vSRX = Interfaces_from_vSRX;
     
        $.ajax({
            url: 'getconfig/',
            type: 'GET',
            dataType: "text",
            
            success: function(response) {
                Config_from_vSRX= response;
                ConfigureDHCP(Interfaces_from_vSRX, Config_from_vSRX);
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function ConfigureDHCP(Interfaces_from_vSRX, Config_from_vSRX) {      
        
        var Config_from_vSRX = Config_from_vSRX;
        var Interfaces_from_vSRX = Interfaces_from_vSRX;
   
        var validatedVLAN = validate_VLAN("DHCPVLANnumber");
        if (validatedVLAN === "Error") {
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DHCP_Pool_Subnet = validate_IP("ipDHCP_Pool"); 
        if (DHCP_Pool_Subnet === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DHCP_Pool_Mask = validateDHCHPPoolMASK("DHCPMaskId");  
        if (DHCP_Pool_Mask === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var First_DHCP_Addr = validate_IP("ipDHCP_First");  
        if (First_DHCP_Addr === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var Last_DHCP_Addr = validate_IP("ipDHCP_Last"); 
        if (Last_DHCP_Addr === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var Default_GW = validate_IP("ipDHCP_DG");
        if (Default_GW === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

        var DNS_Server = validate_IP("ipDHCP_DNS");
        if (DNS_Server === "Error"){
        UnBlockScreen();
        $('#preloader').hide();
        return;
        }

 
        var DNS_Number = parseInt(document.getElementById("HoldZone").value);
   
            if (DNS_Number == 1) {

                var SecondDNS = validate_IP("DNS_1_"); 
                    if (SecondDNS === "Error"){
                    UnBlockScreen();
                    $('#preloader').hide();
                    return;
                    }
                    
                alert (SecondDNS);
            }

        var ZoneToConfig = document.querySelector('input[name="ZoneIDDHCP"]:checked').value;
     
           $.ajax({
              url: '/php/Create_DHCP.php',
              type: 'POST',
              dataType: "text",
              data : {Config_from_vSRX: Config_from_vSRX, Interfaces_from_vSRX: Interfaces_from_vSRX,
                        DHCP_Pool_Subnet: DHCP_Pool_Subnet, DHCP_Pool_Mask: DHCP_Pool_Mask,
                            First_DHCP_Addr: First_DHCP_Addr, Last_DHCP_Addr: Last_DHCP_Addr, 
                                ZoneToConfig: ZoneToConfig, validatedVLAN: validatedVLAN,
                                    DNS_Server: DNS_Server, Default_GW: Default_GW},

              success: function(response) {
 
                  result = response;

                    if (result == "1") {
                       ApplyDeleteSelectedRoute();
                      }

                  else {
                    UnBlockScreen();
                    alert(result);
                    $('#preloader').hide();
                    return;
                  }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });

    }


       
    function GetLANInterfaces(){
     
        var result_from_vSRX;
        $('#preloader').show();
        $.ajax({
            url: 'intMaskVLAN/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
                result_from_vSRX = response;
                LANInterfacesPHP(result_from_vSRX);
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }

    function LANInterfacesPHP(result_from_function){
       
        var result_from_function = result_from_function;
     
        $.ajax({
           url: '/php/LANIPsAndZones.php',
            type: 'POST',
            dataType: "text",
            data : {Input_From_Python : result_from_function},

            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;

                tables = document.getElementById("StatusTable");
                lastRow = document.getElementById("StatusTable").rows.length;

                for (var i = 1; i < lastRow; i++) {                         
                 
                    Row_Index = i;
                    Column_Index = 3;

                    var table = document.getElementById("StatusTable");
                    var LAN_Address_Pointer = table.rows[Row_Index].cells[Column_Index].innerHTML;
                    LAN_Address_Pointer = LAN_Address_Pointer.trim();

                    row = table.rows[i];

                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='LAN_IPAdd_To_Delete_"+ i +"' id='LAN_IPAdd_To_Delete_"+ i +"'             name='DMZ_AddrTo_Delete'/>";

 
                   }

                row = tables.rows[1];
                newCell = row.insertCell(row.cells.length);
                newCell.innerHTML = "<button type='button' onclick='DeleteSelectedLANaddr()'>Delete Address</button>";

                applyCSS();
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
        
    }

    function DeleteSelectedLANaddr(){

        BlockScreen(); 

        var CheckedTest = 0;
        var InterfaceName;
        var AddressforDeletion;
        var LAN_IPAdd_To_Delete = "LAN_IPAdd_To_Delete_";

        tables = document.getElementById("StatusTable");
        lastRow = document.getElementById("StatusTable").rows.length;

            for (var i = 1; i < lastRow; i++) {
                     
            var d = LAN_IPAdd_To_Delete + i;
           
                if(document.getElementById(d).checked) {

                CheckedTest = 1;
                
                Row_Index = i;

                var table = document.getElementById("StatusTable");
                InterfaceName = table.rows[Row_Index].cells[0].innerHTML;
                AddressforDeletion = table.rows[Row_Index].cells[3].innerHTML;

                var answer = confirm("Delete IP Address?");
                 
                    if (answer){
                         
                         $('#preloader').show();

                         $.ajax({
                            url: '/php/DeleteLANDMZIPAddress.php',
                            type: 'POST',
                            dataType: "text",
                            data : {InterfaceName : InterfaceName, AddressforDeletion : AddressforDeletion},

                            success: function(response) {
                                result_from_PHP = response;
                                
                                ApplyDeleteSelectedLANaddr();
    
                                },

                            error: function( xhr, status, errorThrown ) {
                                UnBlockScreen();
                                $('#preloader').hide();    
                                alert( "There was a problem completing the request." );
                                console.log( "Error: " + errorThrown );
                                console.log( "Status: " + status );
                                console.dir( xhr );
                                }
                            });
                        }                       
                    
                    else {
                        UnBlockScreen();
                        return;                 
                    }
               }
            }


        if (CheckedTest == 0) {
            UnBlockScreen();
            alert ("Please indicate IP Address to delete.");
            return;
        }

    }



    function GetDMZInterfaces(){
    
        var result_from_vSRX;
        $('#preloader').show();

        $.ajax({
           url: 'intMaskVLAN/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
            result_from_vSRX = response;
            DMZInterfacesPHP(result_from_vSRX);
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function DMZInterfacesPHP(result_from_function){
      
        var result_from_function = result_from_function;

        $('#bg_container').hide();

        $.ajax({
           url: '/php/DMZIPsAndZones.php',         
            type: 'POST',
            dataType: "text",
            data : {Input_From_Python : result_from_function},

            success: function(response) {

                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;

                tables = document.getElementById("StatusTable");
                lastRow = document.getElementById("StatusTable").rows.length;

                for (var i = 1; i < lastRow; i++) {                         
                 
                    Row_Index = i;
                    Column_Index = 3;

                    var table = document.getElementById("StatusTable");
                    var DMZ_Address_Pointer = table.rows[Row_Index].cells[Column_Index].innerHTML;
                    DMZ_Address_Pointer = DMZ_Address_Pointer.trim();

                    row = table.rows[i];

                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='DMZ_IPAdd_To_Delete_"+ i +"' id='DMZ_IPAdd_To_Delete_"+ i +"' name='DMZ_AddrTo_Delete'/>";

                   }

                row = tables.rows[1];
                newCell = row.insertCell(row.cells.length);
                newCell.innerHTML = "<button type='button' onclick='DeleteSelectedDMZaddr()'>Delete Address</button>";

                applyCSS();
                
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }

    function DeleteSelectedDMZaddr(){

        BlockScreen(); 
        var CheckedTest = 0;
        var InterfaceName;
        var AddressforDeletion;
        var DMZ_IPAdd_To_Delete = "DMZ_IPAdd_To_Delete_";

        tables = document.getElementById("StatusTable");
        lastRow = document.getElementById("StatusTable").rows.length;

            for (var i = 1; i < lastRow; i++) {
                     
            var d = DMZ_IPAdd_To_Delete + i;
           
                if(document.getElementById(d).checked) {

                CheckedTest = 1;
                
                Row_Index = i;

                var table = document.getElementById("StatusTable");
                InterfaceName = table.rows[Row_Index].cells[0].innerHTML;
                AddressforDeletion = table.rows[Row_Index].cells[3].innerHTML;

                var answer = confirm("Delete IP Address?");
                 
                    if (answer){
                         
                         $('#preloader').show();

                         $.ajax({
                            url: '/php/DeleteLANDMZIPAddress.php',
                            type: 'POST',
                            dataType: "text",
                            data : {InterfaceName : InterfaceName, AddressforDeletion : AddressforDeletion},

                            success: function(response) {
                                result_from_PHP = response;
                                
                                ApplyDeleteSelectedDMZaddr();
    
                                },

                            error: function( xhr, status, errorThrown ) {
                                UnBlockScreen(); 
                                $('#preloader').hide();    
                                alert( "There was a problem completing the request." );
                                console.log( "Error: " + errorThrown );
                                console.log( "Status: " + status );
                                console.dir( xhr );
                                }
                            });
                        }                       
                    
                    else {
                        UnBlockScreen(); 
                        return;
                    }
                }
            }


        if (CheckedTest == 0) {
            UnBlockScreen();
            alert ("Please indicate IP Address to delete.");
            return;
        }

    }



    function CollectInfo() {

        $('#SwapPolicyTerms').hide();

        var InfoRequested = document.querySelector('input[name="Status_Info"]:checked').value;
            if (InfoRequested === null ) {
                UnBlockScreen();
                alert("Please select requested action");
                return;
            }

        var Required_FW_Index = document.getElementById("FW_ID").selectedIndex;
            if (Required_FW_Index === 0 ) {
                UnBlockScreen();
                alert("Please select Fusion PE");
                return;
            }

        var Required_FW = document.getElementById("FW_ID").options[Required_FW_Index].text;
   

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW},
    
                success: function(response) {
                result_from_PHP = response;

                    if (InfoRequested === "Routing Table" ) {
                        BlockScreen(); 
                        LoadDoc_Routes();
                     }
                    
                    if (InfoRequested === "Firewall Sessions" ) {
                        ShowFWSessionInfoTable();
                    }
                    if (InfoRequested === "LAN Interfaces") {
                        BlockScreen();
                        GetLANInterfaces();
                    }
                    if (InfoRequested === "DMZ Interfaces") {
                        BlockScreen();
                        GetDMZInterfaces();
                    }
                    if (InfoRequested === "BGP Peers") {
                        BlockScreen();
                        GetBGPPeers();
                    }

                    if (InfoRequested === "VRFs") {
                        BlockScreen();
                        GetVRFs();
                    }

                    if (
                        (InfoRequested === "LAN to WAN") || 
                        (InfoRequested === "LAN to DMZ") ||
                        (InfoRequested === "WAN to LAN") ||
                        (InfoRequested === "WAN to DMZ") ||
                        (InfoRequested === "DMZ to LAN") ||
                        (InfoRequested === "DMZ to WAN")) {
                        BlockScreen();
                        SaveRequestedZones(InfoRequested);
                    }

                    },

                error: function( xhr, status, errorThrown ) {
                    UnBlockScreen();
                    $('#preloader').hide();    
                    alert( "There was a problem obtaining the Firewall IP address." );
                    console.log( "Error: " + errorThrown );
                    console.log( "Status: " + status );
                    console.dir( xhr );
                    }
                });

    }


    function GetVRFs(){

        $('#preloader').show();
        var result_from_function;
        var result;

        $.ajax({
            url: 'GetInstanceInformation/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
                result_from_function = response;

                if (result_from_function === "VRFInfoCollected"){
                //Printer_Routes(result_from_function);
                Print_VRFs();
                }
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request 1." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
        
    }


    function Print_VRFs(){
       
    var VRF = 1;   
     
        $.ajax({
            url: '/php/PrintInstanceInformation.php',
            type: 'POST',
            dataType: "text",
            timeout: 500000,
            data : {VRF : VRF},

            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;

                    if (result_from_PHP == 1) {
                        UnBlockScreen();
                        alert( "No VRFs found." );
                        }

                    else { $('#FWSessionInfo').hide();
                          UnBlockScreen();
                          document.getElementById("StatusTable").innerHTML = result_from_PHP;
                          applyVRFsCSS();
                          }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                },
            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
                }

            });
    }



    function applyVRFsCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "15%");      
        $("table#StatusTable td:nth-child(2) ").css("width", "15%");    
        $("table#StatusTable td:nth-child(3) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(5) ").css("width", "15%"); 
        $("table#StatusTable td").css("text-indent", "5px");
        $("table#StatusTable td").css("text-align", "center");

        UnBlockScreen();
                
        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }






    function GetBGPPeers() {

        $('#preloader').show();
        var result_from_function;
       
        $.ajax({
            url: 'BGPpeerStatus/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
                result_from_function = response;

                if (result_from_function === "BGPPeerStatusCollected"){
                //Printer_Routes(result_from_function);
                Print_BGP_Peers();
                }
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
        
    }


    function Print_BGP_Peers(){
       
    var BGPPeer = 1;   
     
        $.ajax({
            url: '/php/PrintBGPPeers.php',
            type: 'POST',
            dataType: "text",
            timeout: 500000,
            data : {BGPPeer : BGPPeer},

            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;

                    if (result_from_PHP == 1) {
                        UnBlockScreen();
                        alert( "No BGP Peers found." );
                        }

                    else { $('#FWSessionInfo').hide();
                          document.getElementById("StatusTable").innerHTML = result_from_PHP;
                          applyBGPPeersCSS();
                          }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                },
            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
                }

            });
    }


    function applyBGPPeersCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "15%");      
        $("table#StatusTable td:nth-child(2) ").css("width", "15%");    
        $("table#StatusTable td:nth-child(3) ").css("width", "15%"); 
        $("table#StatusTable td:nth-child(4) ").css("width", "15%"); 

        $("table#StatusTable td").css("text-indent", "5px");
        $("table#StatusTable td").css("text-align", "center");

        UnBlockScreen();
                
        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);

    }


   function ShowFWSessionInfoTable(){

        $('#bg_container').hide();
        $("#StatusTable tr").remove();
        $('#FWSessionInfo').show();

    }

   function HideFWSessionInfoTable(){

        $('#FWSessionInfo').hide();

    }

    
    function GetFirewallSessions(){

        BlockScreen(); 
  
        var SessionSRC = "0.0.0.0/0";
        var SessionDST = "0.0.0.0/0";
        var SessionTrafficCheckedTest = 0;
        var SessionTrafficS = "SessionTrafficSelect"

       for (var i = 1; i < 4; i++) {

            var d = SessionTrafficS + i;

            if (document.getElementById(d).checked) {

            var SessionSpec = document.querySelector('input[name="SessionTrafficSelect"]:checked').value;
            SessionTrafficCheckedTest = 1;
            }
        }

        if (SessionTrafficCheckedTest == 0) {
            alert ("Please indicate which part of the FW session traffic is specified.");
            UnBlockScreen();
            $('#preloader').hide();  
            return;
        }


        if (SessionSpec === "SourceDestination" ) {

            SessionSRC = validate_IP("FWSessionSource");
            if (SessionSRC === "Error") {
            UnBlockScreen();
            return; 
            }

            SessionDST = validate_IP("FWSessionDestination");
            if (SessionDST === "Error") {
            UnBlockScreen();
            return; 
            }

        }

        if (SessionSpec === "SourceOnly" ) {

            SessionSRC = validate_IP("FWSessionSource");
            if (SessionSRC === "Error") {
            UnBlockScreen();
            return; 
            }

        }

        if (SessionSpec === "DestinationOnly" ) {

            SessionDST = validate_IP("FWSessionDestination");
            if (SessionDST === "Error") {
            UnBlockScreen();
            return; 
            }
        }


        var Required_FW_Index = document.getElementById("FW_ID").selectedIndex;
            if (Required_FW_Index === 0 ) {
                UnBlockScreen();
                alert("Please select Fusion PE");
                return;
            }

        var Required_FW = document.getElementById("FW_ID").options[Required_FW_Index].text;

        $('#preloader').show(); 

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW}, 
                success: function(response) {
                result_from_PHP = response;
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });


            $.ajax({
              url: '/php/SaveSessionSRCandDest.php',
              type: 'POST',
              dataType: "text",
              data : {SessionSpec: SessionSpec, SessionSRC: SessionSRC, SessionDST: SessionDST},

              success: function(response) {
 
                result = response;

                    if (result == 1) {
                        UniqueSession();
                    }

                    else {
                       alert (result);
                       UnBlockScreen();
                       $('#preloader').hide();
                       return;
                    }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });

    }


    function UniqueSession() {

        $.ajax({
            url: 'UniqueSession/',
            type: 'GET',
            dataType: "text",
            timeout: 50000000,
            success: function(response) {
            RenderFWSessions(); 
            result = response;              
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                result = response;  
                $('#preloader').hide();    
                //alert( "There was a problem completing the request Sessions." );
                alert(result);
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    
    }


    function RenderFWSessions(){
       
    var SessionsStatus = 1;   
     
        $.ajax({
            url: '/php/RenderFWSessions.php',
            type: 'POST',
            dataType: "text",
            timeout: 500000,
            data : {SessionsStatus : SessionsStatus},

            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;

                    if (result_from_PHP == 1) {
                        UnBlockScreen();
                        alert( "No sessions found." );
                        }

                    else { $('#FWSessionInfo').hide();
                          document.getElementById("StatusTable").innerHTML = result_from_PHP;
                          applyUniqueFWSessionsCSS();
                          }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                },
            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
                }

            });
    }



    function SaveRequestedZones(DataFromUser){
       
        var SaveRequestedZones = DataFromUser;
        
        $.ajax({
            url: '/php/SaveRequestedZones.php',
            type: 'POST',
            dataType: "text",
            data : {SaveRequestedZones : SaveRequestedZones},
            success: function(response) {
                $('#preloader').hide();
                GetPolicyConfiguration();		
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }

    function DisplayPolicyConfig(DataFromFW){
       
        var DataFromFW = DataFromFW;
     
        $.ajax({
            url: '/php/GetPolicyConfig.php',
            type: 'POST',
            dataType: "text",
            data : {DataFromFW : DataFromFW},
            success: function(response) {
                $('#preloader').hide();
                $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;

                tables = document.getElementById("StatusTable");
                lastRow = document.getElementById("StatusTable").rows.length;


                for (var i = 1; i < lastRow; i++) {
             
                   row = tables.rows[i];

                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='Term_To_Delete_"+ i +"' id='Term_To_Delete_"+ i +"' name='Term_To_Delete'/>";
                                                                 
                }

                applyPoliciesCSS();
                PolicyTermsFound();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }

    function PolicyTermsFound(){       
    
        removeOptions(document.getElementById("MoveThisTerm"));
        removeOptions(document.getElementById("MoveToThisTerm"));

        $.ajax({
            type: "GET",
            url: '/php/PolicyTermsFound.php',
            dataType: "text",

            success: function (data) {
             
                var res = data.split(" ");
            
                $.each(res, function(key, value) {   
                $('#MoveThisTerm')
                .append($("<option></option>")
                .attr("value",key)
                .text(value)); 

                $('#MoveToThisTerm')
                .append($("<option></option>")
                .attr("value",key)
                .text(value)); 
       
                $('#SwapPolicyTerms').show();

                });

            }
        });
            
    }

    function MoveTerms() {

        BlockScreen(); 
        
        $('#preloader').show();

        var PolicyTermA_Index = document.getElementById("MoveThisTerm").selectedIndex;
        if (PolicyTermA_Index === 0 ) {
            UnBlockScreen();
            $('#preloader').hide();
            alert("Please select First Policy Term");
            return;
        }
        var PolicyTermA = document.getElementById("MoveThisTerm").options[PolicyTermA_Index].text;


        var PolicyTermB_Index = document.getElementById("MoveToThisTerm").selectedIndex;
        if (PolicyTermB_Index === 0 ) {
            UnBlockScreen();
            $('#preloader').hide();
            alert("Please select Second Policy Term");
            return;
        }
        var PolicyTermB = document.getElementById("MoveToThisTerm").options[PolicyTermB_Index].text;

        if ( PolicyTermA === PolicyTermB ) {
            $('#preloader').hide();
            UnBlockScreen();
            alert("Policy Terms have to be different.");
            return;
        }

        var TermMoveDirection = document.querySelector('input[name="PolicyMoveDirection"]:checked').value;

        $.ajax({
            url: '/php/ReOrderPolicy.php',
            type: 'POST',
            dataType: "text",
            data : {PolicyTermA: PolicyTermA, 
                        PolicyTermB: PolicyTermB,
                            TermMoveDirection: TermMoveDirection},
            success: function(response) {
                result = response;
                ApplyMoveTerms();
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }

    function ApplyMoveTerms() {

        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 300000,
            dataType: "text",
            success: function(response) {
                GetPolicyConfiguration();
                result = response;
                $('#preloader').hide();
                alert(result);
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                UnBlockScreen();
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function removeOptions(selectbox) {

        var i;
        for(i=selectbox.options.length-1;i>=1;i--)
        {
            selectbox.remove(i);
        }

    }

 
    function GetPolicyConfiguration() {

        $('#preloader').show();
        var DataFromFW;
        $.ajax({
            url: 'PolicyRules/',
            type: 'GET',
            dataType: "text",

            success: function(response) {
                DataFromFW = response;
                DisplayPolicyConfig(DataFromFW);				
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function ApplyStaticRoute(){

        BlockScreen();

        var RouteSUBNET = validate_IP("ipStaticRouteSubnet");
        if (RouteSUBNET === "Error") {
            UnBlockScreen();  
            return; 
        }
        
        var RouteMASK = validateMASK("StaticRouteMASKId");   
        if (RouteMASK === "Error") {
            UnBlockScreen(); 
            return; 
        }

        var RouteNextHop = validate_IP("ipStaticRouteNextHop");
        if (RouteNextHop === "Error") {
            UnBlockScreen(); 
            return; 
        }
     

        var addr = ipaddr.parse(RouteNextHop);
        var range = ipaddr.parse(RouteSUBNET);         
        var RouteMASKToint = parseInt(RouteMASK);
        if (addr.match(range, RouteMASKToint) && (RouteSUBNET != "0.0.0.0")){ 
           alert ("The next hop cannot be part of the route subnet.");
           UnBlockScreen();  
           return; 
        }

        var Required_FW_Index = document.getElementById("FW_ID_StaticRoute").selectedIndex;
            if (Required_FW_Index == 0 ) {
                UnBlockScreen();
                alert("Please select Fusion PE.");
                return;
            }

        $('#preloader').show();

        var Required_FW = document.getElementById("FW_ID_StaticRoute").options[Required_FW_Index].text;

            $.ajax({
                url: '/php/ObtainFWIPAddress.php',
                type: 'POST',
                dataType: "text",
                data : {Required_FW : Required_FW},

                success: function(response) {
                result_from_PHP = response;

                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
            

            $.ajax({
              url: '/php/ApplyStaticRoute.php',
              type: 'POST',
              dataType: "text",
              data : {RouteSUBNET: RouteSUBNET, RouteMASK: RouteMASK, RouteNextHop: RouteNextHop},

              success: function(response) {
 
                result = response;

                    if (result == 1) {
                        ApplyDeleteSelectedRoute();
                    }

                    else {
                       alert (result);
                       // alert("There was a problem with the configuration generation.");
                        UnBlockScreen();
                        $('#preloader').hide();
                        return;
                    }
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
               console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
      
    }


    function ApplyRenamingTableCSS() {
    
        $("table#Rename_Device_Table th").css("border","1px solid #000");
        $("table#Rename_Device_Table td").css("border","1px solid #000");

        $("table#Rename_Device_Table tr:even").css("background-color", "#FFF");
        $("table#Rename_Device_Table tr:odd").css("background-color", "#CCC");
                 
        $('#Rename_Device_Table tr:first').css("background-color", "#FFFFFF");
        $('#Rename_Device_Table tr:first').css("font-weight", "bold");
        $('#Rename_Device_Table tr:first').css("text-align", "center");

        $("table#Rename_Device_Table td:nth-child(1) ").css("width", "150px");      
        $("table#Rename_Device_Table td:nth-child(2) ").css("width", "150px");    
        $("table#Rename_Device_Table td:nth-child(3) ").css("width", "40px"); 
        $("table#Rename_Device_Table td:nth-child(3) ").css("text-align", "center"); 

        $("table#Rename_Device_Table td:nth-child(4) ").css("width", "150px"); 

        $("table#Rename_Device_Table td").css("text-align", "center");
    }

    function isAlphaNumeric(str) {
      
      var code, i, len;
      var ItIsLegal = "ItIsLegal";
      var ItIsNotLegal = "ItIsNotLegal";
      for (i = 0, len = str.length; i < len; i++) {
        code = str.charCodeAt(i);
        if (!(code > 47 && code < 58) && // numeric (0-9)
            !(code > 64 && code < 91) && // upper alpha (A-Z)
            !(code > 96 && code < 123)) { // lower alpha (a-z)
          return ItIsNotLegal;
        }
      }
      return ItIsLegal;
    }


    function Rename_Device() {    
    
    var CheckedTest = 0;
    var New_FW_Name;
    var Old_FW_Name;
    var New_Name_Lenght;
    var FWToRenamePointer = 0;
    var FW_To_RenCheckBoxes = "Rename_This_FW_ID_";
    var IsNewNameAString; 
    var Row_Index;
    var Column_Index;
    var tables;
    var lastRow;
    var CheckNameConflict;
   
    tables = document.getElementById("Rename_Device_Table");
    lastRow = document.getElementById("Rename_Device_Table").rows.length;

        for (var i = 1; i < lastRow; i++) {
                 
        var d = FW_To_RenCheckBoxes + i;
       
            if(document.getElementById(d).checked) {

            CheckedTest = 1;
            FWToRenamePointer = document.querySelector('input[name="FW_To_Rename"]:checked').value;
            
            New_FW_Name = document.getElementById(FWToRenamePointer).value;
            New_FW_Name = New_FW_Name.trim();

            var New_Name_Lenght = New_FW_Name.length;

                if (New_Name_Lenght < 4 || New_Name_Lenght > 20) {
                    alert ("Please use a new local Identifier of length between 4 and 20 characters")
                    return;
                } 

            Row_Index = i;
            Column_Index = 1;

            var table = document.getElementById("Rename_Device_Table");
            Old_FW_Name = table.rows[Row_Index].cells[Column_Index].innerHTML;
            Old_FW_Name = Old_FW_Name.trim();

            var RenamingSID = table.rows[Row_Index].cells[0].innerHTML;
            RenamingSID = RenamingSID.trim();
           }

       }

        if (CheckedTest == 0) {
            alert ("Please indicate device to rename");
            return;
        }
        
        for (var i = 1; i < lastRow; i++) {

        Row_Index = i;

        CheckNameConflict = table.rows[Row_Index].cells[1].innerHTML;
        CheckNameConflict = CheckNameConflict.trim();

        if (CheckNameConflict == New_FW_Name ) {

            alert ("Requested new name is already used.");
            return;
        }

        }

        IsNewNameAString = isAlphaNumeric(New_FW_Name);

        if ( IsNewNameAString === "ItIsNotLegal" ) {
            alert ("Please only use alpanumeric values for the new local Identifier.");
            return;
        } 

        $.ajax({
            url: '/php/ApplyNewFWName.php',
            type: 'POST',
            dataType: "text",
            data : {Old_FW_Name : Old_FW_Name, New_FW_Name: New_FW_Name, RenamingSID:RenamingSID},

            success: function(response) {
                result_from_PHP = response;
                
                GetICCFirewalls();
                OnStartPopulateRename();
                
                alert ("Device Renaming completed.");    
                },

            error: function( xhr, status, errorThrown ) {
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }

        });

    }


    function DeletePolicyTerm(){

        BlockScreen();

        var CheckedTest = 0;
        var PointerToTerm;
        var TermToBeDeleted;
        var Term_To_Delete = "Term_To_Delete_";

        tables = document.getElementById("StatusTable");
        lastRow = document.getElementById("StatusTable").rows.length;

            for (var i = 1; i < lastRow; i++) {
                     
            var d = Term_To_Delete + i;
           
                if(document.getElementById(d).checked) {

                CheckedTest = 1;
                
                Row_Index = i;
                Column_Index = 0;

                var table = document.getElementById("StatusTable");
                TermToBeDeleteded = table.rows[Row_Index].cells[Column_Index].innerHTML;

                var answer = confirm("Delete policy term?");
                 
                    if (answer){
                         
                         $('#preloader').show();

                         $.ajax({
                            url: '/php/DeletePolicyTerm.php',
                            type: 'POST',
                            dataType: "text",
                            data : {TermToBeDeleteded : TermToBeDeleteded},

                            success: function(response) {
                                result_from_PHP = response;
                                
                                ApplyDeletePolicyTerm();
    
                                },

                            error: function( xhr, status, errorThrown ) {
                                UnBlockScreen();
                                $('#preloader').hide();    
                                alert( "There was a problem completing the request." );
                                console.log( "Error: " + errorThrown );
                                console.log( "Status: " + status );
                                console.dir( xhr );
                                }
                            });
                        }                       
                    
                    else {
                        UnBlockScreen();
                        return;
                   }
               }
            }

        if (CheckedTest == 0) {
            UnBlockScreen();
            alert ("Please indicate policy term to delete.");
            return;
        }

    }

    function ApplyDeletePolicyTerm() {

        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 300000,
            dataType: "text",
            success: function(response) {

                result = response;                
                alert(result);
                GetPolicyConfiguration();
                $('#preloader').hide();
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                UnBlockScreen();
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    } 

    function DeleteSelectedRoute(){
        
        BlockScreen();

        var CheckedTest = 0;
        var PointerToRoute;
        var RouteToBeDeleted;
        var RouteType;
        var RoutePrefixColumnIndex = 0;
        var InterfaceColumnIndex = 2;
        var RouteTypeColumnIndex = 3;
        var LocalAddress = "None";
        var LocalAddressIndex;
        var Interface = "None";
        var Static_Route_To_Delete = "Static_Route_To_Delete_";
        var Is_This_a_RadioButton;

        tables = document.getElementById("StatusTable");
        lastRow = document.getElementById("StatusTable").rows.length;

            for (var i = 1; i < lastRow; i++) {
            
            Is_This_a_RadioButton = tables.rows[i].cells[4].innerHTML;
            Is_This_a_RadioButton = Is_This_a_RadioButton.trim();

            
            if (Is_This_a_RadioButton != "N/A") {

                var d = Static_Route_To_Delete + i;      

                    if(document.getElementById(d).checked) {

                    CheckedTest = 1;
                    
                    Row_Index = i;

                    var table = document.getElementById("StatusTable");
                    RouteType = table.rows[Row_Index].cells[RouteTypeColumnIndex].innerHTML;
                    RouteToBeDeleted = table.rows[Row_Index].cells[RoutePrefixColumnIndex].innerHTML;

                    RouteType = RouteType.trim();
                    RouteToBeDeleted = RouteToBeDeleted.trim();

                   
                        if (RouteType == "Direct") {

                        Interface = table.rows[Row_Index].cells[InterfaceColumnIndex].innerHTML;
                        Interface = Interface.trim();    
                        LocalAddressIndex = Row_Index + 1;

                        LocalAddress = table.rows[LocalAddressIndex].cells[RoutePrefixColumnIndex].innerHTML;
                        LocalAddress = LocalAddress.trim();
                        alert (LocalAddress);
                        }

                        if  (RouteToBeDeleted == "0.0.0.0/0") {

                            var answer = confirm("Delete the Default Route of this site?");
                        }

                        else {

                            var answer = confirm("Delete selected route?");                    
                        }

                        if (answer){

                             $('#preloader').show();

                             $.ajax({
                                url: '/php/DeleteSelectedRoute.php',
                                type: 'POST',
                                dataType: "text",
                                data : {RouteType : RouteType , RouteToBeDeleted : RouteToBeDeleted , 
                                        LocalAddress : LocalAddress , Interface : Interface},

                                success: function(response) {
                                    result_from_PHP = response;
                                    
                                    ApplyDeleteSelectedRoute();

                                    },

                                error: function( xhr, status, errorThrown ) {
                                    UnBlockScreen();
                                    $('#preloader').hide();    
                                    alert( "There was a problem completing the request." );
                                    console.log( "Error: " + errorThrown );
                                    console.log( "Status: " + status );
                                    console.dir( xhr );
                                    }
                                });

                        }                       
                            
                        else {
                            UnBlockScreen();
                            return;
                           
                        }
                    }
                }
            }

        if (CheckedTest == 0) {
            UnBlockScreen();
            alert ("Please indicate static route or interface address to delete.");
            return;
        }

    }

    function ApplyDeleteSelectedRoute() {

        var Row_Index = Row_Index;
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 300000,
            dataType: "text",
            success: function(response) {
                UnBlockScreen();
                result = response;
                LoadDoc_Routes();
                alert(result);
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                UnBlockScreen();
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
    }


    function ApplyDeleteSelectedLANaddr() {

        var Row_Index = Row_Index;
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 500000,
            dataType: "text",
            success: function(response) {
                result = response;
                GetLANInterfaces();
                alert(result);
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
       
    }


    function ApplyDeleteSelectedDMZaddr() {

        var Row_Index = Row_Index;
       
        $.ajax({
            url: 'configuration/',
            type: 'GET',
            timeout: 500000,
            dataType: "text",
            success: function(response) {
                UnBlockScreen();
                result = response;
                GetDMZInterfaces();
                $('#preloader').hide();
                alert(result);
                LogChange();
            },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
            },

            complete: function( xhr, status ) {
                UnBlockScreen();
                $('#preloader').hide(); 
                console.log(xhr, status);
            }
        });
       
    }


        function DisplaySystemLogs(){

        $('#SwapPolicyTerms').hide();
         HideFWSessionInfoTable();

         
        $.ajax({
            url: '/php/GetLogs.php',
            type: 'POST',
            dataType: "text",

            success: function(response) {
               
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;
                },

            error: function( xhr, status, errorThrown ) {
                UnBlockScreen();
                $('#preloader').hide();    
                alert( "There was a problem completing the request." );
                console.log( "Error: " + errorThrown );
                console.log( "Status: " + status );
                console.dir( xhr );
                }
            });
    }


    function DisplayAllICCFirewalls(){
        
        HideFWSessionInfoTable();
        $('#SwapPolicyTerms').hide();

        $.ajax({
            url: '/php/DisplayAllICCFirewalls.php',
            type: 'POST',
            dataType: "text",
            success: function(response) {
                 $('#bg_container').hide();
                result_from_PHP = response;
                document.getElementById("StatusTable").innerHTML = result_from_PHP;

                tables = document.getElementById("StatusTable");
                lastRow = document.getElementById("StatusTable").rows.length;

                for (var i = 1; i < lastRow; i++) {
             
                    row = tables.rows[i];
                                                            
                    newCell = row.insertCell(row.cells.length);
                    newCell.innerHTML = "<input type='Radio' value='FW_From_DB_"+ i +"' id='FW_From_DB_"+ i +"' name='FW_From_DB'/>";
                                                                 
                }

                row = tables.rows[1];
                newCell = row.insertCell(row.cells.length);
                newCell.innerHTML = "<button type='button' onclick='DeleteFWfromDB()'>Delete PE From Database</button>";

                applyFWDBCSS();
            }
        });
    }


    function applyFWDBCSS(){ 

        $("table#StatusTable th").css("border","1px solid #000");
        $("table#StatusTable td").css("border","1px solid #000");

        $("table#StatusTable tr:even").css("background-color", "#FFF");
        $("table#StatusTable tr:odd").css("background-color", "#CCC");
                 
        $('#StatusTable tr:first').css("background-color", "#FFFFFF");
        $('#StatusTable tr:first').css("font-weight", "bold");
        $('#StatusTable tr:first').css("text-align", "center");

        $("table#StatusTable td:nth-child(1) ").css("width", "300px"); 
        $("table#StatusTable td:nth-child(1) ").css("text-align", "center");     
        $("table#StatusTable td:nth-child(2) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(2) ").css("text-align", "center");   
        $("table#StatusTable td:nth-child(3) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(3) ").css("text-align", "center");

        $("table#StatusTable td:nth-child(4) ").css("width", "250px"); 
        $("table#StatusTable td:nth-child(4) ").css("text-align", "center");

        $("table#StatusTable td:nth-child(5) ").css("background-color", "#FFF");
        $("table#StatusTable td:nth-child(5) ").css("border","1px solid #FFF");
        $("table#StatusTable td:nth-child(5) ").css("width", "350px");


        $("table#StatusTable td").css("text-indent", "5px");

        var newHeight = $("#StatusTable").height() + 140;
        $("body").css("height", newHeight);
        
      //  $("table#StatusTable th").css("text-align", "center");

        UnBlockScreen();

    }

    function DeleteFWfromDB(){

        BlockScreen();

        var CheckedTest = 0;
        var PointerToTerm;
        var TermToBeDeleted;
        var FW_From_DB = "FW_From_DB_";

        tables = document.getElementById("StatusTable");
        lastRow = document.getElementById("StatusTable").rows.length;

            for (var i = 1; i < lastRow; i++) {
                     
            var d = FW_From_DB + i;
           
                if(document.getElementById(d).checked) {

                CheckedTest = 1;
                
                Row_Index = i;
                Column_Index = 0;

                var table = document.getElementById("StatusTable");
                FirewallToBeDeleteded = table.rows[Row_Index].cells[Column_Index].innerHTML;

                var answer = confirm("Delete Fusion PE from Database?");
                 
                    if (answer){
                         
                        $.ajax({
                            url: '/php/DeleteFWfromDB.php',
                            type: 'POST',
                            dataType: "text",
                            data : {FirewallToBeDeleteded : FirewallToBeDeleteded},

                            success: function(response) {
                                result_from_PHP = response;
                                DisplayAllICCFirewalls();
                                GetICCFirewalls();
                                UnBlockScreen();
                                alert (result_from_PHP);
                                },

                            error: function( xhr, status, errorThrown ) {
                                UnBlockScreen();
                                $('#preloader').hide();    
                                alert( "There was a problem completing the request." );
                                console.log( "Error: " + errorThrown );
                                console.log( "Status: " + status );
                                console.dir( xhr );
                                }
                            });
                        }                       
                    
                    else {
                        UnBlockScreen();
                        return;
                   }
               }
            }

        if (CheckedTest == 0) {
            UnBlockScreen();
            alert ("Please indicate firewall to delete.");
            return;
        }

    }



var IDLE_TIMEOUT = 60; //seconds
var _idleSecondsCounter = 0;
document.onclick = function() {
    _idleSecondsCounter = 0;
};
document.onmousemove = function() {
    _idleSecondsCounter = 0;
};
document.onkeypress = function() {
    _idleSecondsCounter = 0;
};
window.setInterval(CheckIdleTime, 1000);

function CheckIdleTime() {
    _idleSecondsCounter++;
    var oPanel = document.getElementById("SecondsUntilExpire");
    if (oPanel)
        oPanel.innerHTML = (IDLE_TIMEOUT - _idleSecondsCounter) + "";
    if (_idleSecondsCounter >= IDLE_TIMEOUT) {
        document.location.href = "/logout/";
        //alert("Session expired.");
    }
}





    


</script>
 
 
<body onload="updateClock(); setInterval('updateClock()', 1000 );GetICCFirewalls(); HideSwapTerms(); HideFWSessionInfoTable();OnStartPopulateRename();">
</body>

<body style="height:auto;">

<head>
    <title>ICC Firewall</title>   
</head>
 
 

<header style ="vertical-align: middle;">
 
<h1 style="font-size: 30px; position:fixed; vertical-align:middle;">

    <img src="{% static "/static/interoute_logo.jpg" %}" alt="interoute_logo" 
        height="50" width="120" 
        style ="position:fixed; top:1mm; left:3%;"/>

 

<p style = "position: relative;
  top: 50%;
  transform: translateY(-35%);
  left: 380%;"
>Fusion PE Portal</p>

</h1>
 
 
{% if user.is_authenticated %}
<a style ="position:fixed; top:0px; right:0px; height: 20px; width: 70px;" href="/logout/">Logout</a><br />
<a style ="position:fixed; top:0px; right:80px; height: 20px; width: 100px;" href="/passwordreset/">Change Password</a><br />
{% else %}
<a style ="position:fixed; top:0px; right:0px;" href="/user_login/">Login</a><br />
{% endif %}

  
</header>
 


<div>
      <h2></h2>
      <ul class="nav nav-pills" style ="margin-left: 5mm; margin-top: 2cm;">
        <li class="active"><a data-toggle="pill" href="#Administration">Status</a></li>
        <li><a data-toggle="pill" href="#Configure_Interface">Configure Interface</a></li>
        <li><a data-toggle="pill" href="#DHCP">Configure DHCP</a></li>
        <li><a data-toggle="pill" href="#New_Policy">Configure Policy</a></li>
        <li><a data-toggle="pill" href="#Static_Route">Add Static Route</a></li>
        <li><a data-toggle="pill" href="#Rename_Device">Rename Device</a></li>
      </ul>
 

<div class="tab-content">


<div id="preloader" style="position:absolute; top:50%; left:50%; ">
    <img src="{% static "/static/ajax-loader.gif" %}" alt="AJAX loader" title="AJAX loader"/>
</div>


<div id="Administration" class="tab-pane fade in active" style ="position=absolute;">
<h3></h3>




<nav style="margin-left:0px;">
 
    <table style="margin-bottom: 1000px;">
      <tbody>

        <tr><td bgcolor="#eeeeee" style="line-height:10px;" colspan=10>&nbsp;</td></tr>
        <tr><td><input type='radio' name='Status_Info' value='Routing Table' style ="margin-right:6px;">
            <label>Routing Table</label></td></tr>
        <tr class="alt"><td><input type='radio' name='Status_Info' value='Firewall Sessions' style ="margin-right:6px;">
            <label>Firewall Sessions</label></td></tr>
        <tr><td><input type='radio' name='Status_Info' value='LAN Interfaces' style ="margin-right:6px;">
            <label>LAN Interfaces</label></td></tr>
        <tr class="alt"><td><input type='radio' name='Status_Info' value='DMZ Interfaces' style ="margin-right:6px;">
            <label>DMZ Interfaces</label></td></tr>

        <tr class="alt"><td><input type='radio' name='Status_Info' value='BGP Peers' style ="margin-right:6px;">
            <label>BGP Peers</label></td></tr>

        <tr class="alt"><td><input type='radio' name='Status_Info' value='VRFs' style ="margin-right:6px;">
            <label>VRFs</label></td></tr>


        <tr><td bgcolor="#eeeeee" style="line-height:10px;" colspan=3>&nbsp;</td></tr>
        <tr><td><label> Policy Configuration </label></td></tr>
        <tr><td><input type='radio' name='Status_Info' value='LAN to WAN' style ="margin-right:6px; margin-left:20px;">
            <label>LAN to WAN</label></td></tr>
        <tr class="alt"><td><input type='radio' name='Status_Info' value='LAN to DMZ' style ="margin-right:6px; margin-left:20px;">
            <label>LAN to DMZ</label></td></tr>
        <tr><td><input type='radio' name='Status_Info' value='WAN to LAN' style ="margin-right:6px; margin-left:20px;">
            <label>WAN to LAN</label></td></tr>
        <tr class="alt"><td><input type='radio' name='Status_Info' value='WAN to DMZ' style ="margin-right:6px; margin-left:20px;">
            <label>WAN to DMZ</label></td></tr>
        <tr><td><input type='radio' name='Status_Info' value='DMZ to LAN' style ="margin-right:6px; margin-left:20px;">
            <label>DMZ to LAN</label></td></tr>
        <tr class="alt"><td><input type='radio' name='Status_Info' value='DMZ to WAN' style ="margin-right:6px; margin-left:20px;">
            <label>DMZ to WAN</label></td></tr> 


        <tr><td bgcolor="#eeeeee" style="line-height:10px;" colspan=10>&nbsp;</td></tr>
        <tr><td><select id="FW_ID"; style="text-align: center";>
            <option value="">Fusion PE</option></select></td></tr>
                    <tr><td bgcolor="#eeeeee" style="line-height:20px;" colspan=10>&nbsp;</td></tr>

        <tr><td><button type="button" onclick="CollectInfo()" id="Collect_Info_Button" class="navbuttons">Display Information</button></td></tr>
        
        <tr><td><button type="button" onclick="DisplaySystemLogs()" id="Collect_Info_Button" class="navbuttons">Display System Logs</button></td></tr>

        <tr><td><button type="button" onclick="DisplayAllICCFirewalls()" id="Collect_Info_Button" class="navbuttons">Display All Fusion PEs</button></td></tr>


      </tbody>
    </table>

</nav>



<section id = "ResultsSection" style="margin-top:10px; margin-left:40px; background-color: white;">

    <table>
      <tbody>

    <tr><td><table id="StatusTable" class="StatusTable"></table></td>



        <td><table id = "SwapPolicyTerms" style="position:absolute; top:16%;">
          <tbody>
            
            <tr><td style="width: 120px;"><div style="height: 50px; margin-top:20px; margin-bottom:30px;">

                <button type="button" style ="margin-right:10px;" 
                onclick="DeletePolicyTerm()" id="Delete_Policy_Button">Delete Policy term</button>

            </div></td></tr>
           
            <tr><td><div style="height: 30px;"><b>Move Policy term:</b></div></td></tr>
            
            <tr><td><div style="height: 30px;"><select id="MoveThisTerm"; style="text-align: center";><option value="">Term A</option>
            </select></div></td></tr>
            
            <tr><td><input type='radio' name='PolicyMoveDirection' value='Before' checked="checked" style ="margin-right:1px;">
            <label style ="text-indent:10px;">Before</label></td></tr> 
            <tr><td><input type='radio' name='PolicyMoveDirection' value='After'>
            <label style ="text-indent:10px;">After</label></td></tr>                                              

            <tr><td><div style="height: 30px;"><b>Policy term:</b></div></td></tr>
            <tr><td><div style="height: 30px;"><select id="MoveToThisTerm"; style="text-align: center";><option value="">Term B</option>
            </select></div></td></tr>

            <tr><td><button type="button" onclick="MoveTerms()" id="Re_order_Policy_Button">Re-order Policy</button></td></tr>

          </tbody>
        </table>


        </td></tr>

        <tr><td>
                <div id = "FWSessionInfo" style="position:absolute; top:18%;">
                <table>
                    <tbody>

                        <tr>
                            <div id="FWSessionsBanner" style="margin-bottom: 3%; margin-top: 2%;">

                            <p><b>Enter the Source and-or Destination IP addresses to identify established Firewall sessions.</p></b>

                            </div>
                        </tr>


                        <tr><div style = "margin-top: 3%;"> <label style ="text-indent:0%;">Session Source IP Address: </label></div></tr>
                        <tr> 
                            <div id="FWSessionSourc">
                                <input type="text" id="FWSessionSource1" onkeypress="return changeTab('FWSessionSource1',event)" />
                                <input type="text" id="FWSessionSource2" onkeypress="return changeTab('FWSessionSource2',event)" />
                                <input type="text" id="FWSessionSource3" onkeypress="return changeTab('FWSessionSource3',event)" />
                                <input type="text" id="FWSessionSource4" onkeypress="return changeTab('FWSessionSource4',event)" /> </br>
                            </div>
                        </tr>    


                        <tr><div style = "margin-top: 3%;"> <label style ="text-indent:0%;">Session Destination IP Address: </label></div></tr>
                        <tr>
                            <div id="FWSessionDestinatn" style = "margin-bottom: 2%;">
                                <input type="text" id="FWSessionDestination1" onkeypress="return changeTab('FWSessionDestination1',event)" />
                                <input type="text" id="FWSessionDestination2" onkeypress="return changeTab('FWSessionDestination2',event)" />
                                <input type="text" id="FWSessionDestination3" onkeypress="return changeTab('FWSessionDestination3',event)" />
                                <input type="text" id="FWSessionDestination4" onkeypress="return changeTab('FWSessionDestination4',event)" /> </br>
                            </div>                            
                        </tr>

                        <tr><td>
                            <div style="height: 2%; margin-top: 2%; margin-bottom: 1%"><p><b>I am specifying...</b></p></div>
                        </td></tr>    

                        <tr><td><input type='radio' id="SessionTrafficSelect1" name='SessionTrafficSelect' value='SourceOnly' 
                            style ="margin-right:0%;"> <label style ="text-indent:0%;">Source only</label></td></tr>

                        <tr class="alt"><td><input type='radio' id="SessionTrafficSelect2" name='SessionTrafficSelect' value='DestinationOnly' 
                            style ="margin-right:0.5%;"> <label style ="text-indent:0%;">Destination only</label></td></tr>

                        <tr><td><input type='radio' id="SessionTrafficSelect3" name='SessionTrafficSelect' value='SourceDestination' 
                            style ="margin-right:0.5%;"> <label style ="text-indent:0%;">Source & Destination</label></td></tr>

                        <tr><td>
                            <div style="height: 5%;" align="right" style = "margin-top: 5%;">
                                            <button type="button" style ="margin-right: 0.5%;" style = "margin-top: 5%;"
                                                onclick="GetFirewallSessions()" id="GetFirewallSessions">Get Firewall Sessions</button>
                            </div>
                        </td></tr>

                    </tbody>

                </table>            

            </div>
            </td></tr>



      </tbody>
    </table>


</section>
 

<div id="bg_container">



<!img src="{% static '/static/interoute_logo_looping_03.gif' %}" alt="interoute_gif" style="position: relative; top: 120%; left: 0%;" width="250" height="150"/>

<!img src="{% static '/static/o2_logo.jpg' %}" alt="o2_jpg" style="position: relative; top: 120%; left: 0%;" width="250" height="150"/>


<video name='demo' id="bVideo" autoplay="autoplay" loop='true' muted='true' width='30%' height='20%' position: relative; top: 120%; left: 10%>
<source src="{% static '/static/Social_Media_Floating_Bubbles.mp4' type='video/mp4' %}"></source>
</video>

</div>
    
</br>

</div>




<div id="New_Policy" class="tab-pane fade" style ="margin-left: 25px;">
<h3>New Policy</h3>

<p><b>Please enter Source and Destination IP Addresses and prefix.</b></p> 
<p style="color:#cc3300;"><b>Please enter a subnet prefix exactly corresponding 
 to the network address . For example,</br> enter 10.10.10.0/24, not 10.10.10.10/24.
 If a specific, non-subnet address is needed,</br> please specify a /32 prefix.</b></p>
</br>

 
    <div id="inputIP">
        <input type="text" id="ip1" onkeypress="return changeTab('ip1',event)" />
        <input type="text" id="ip2" onkeypress="return changeTab('ip2',event)" />
        <input type="text" id="ip3" onkeypress="return changeTab('ip3',event)" />
        <input type="text" id="ip4" onkeypress="return changeTab('ip4',event)" /> </br>
        <label>Source IP Address</label>
    </div>
 
    <div id="inputMASK">
        <input type="text" id="MaskId" onkeypress="return RemoveDots('MaskId',event)"/></br>
        <label>Source IP Prefix</label></br></br>
    </div>
 
 
    <div id="inputIP">
        <input type="text" id="ipd1" onkeypress="return changeTab('ipd1',event)" />
        <input type="text" id="ipd2" onkeypress="return changeTab('ipd2',event)" />
        <input type="text" id="ipd3" onkeypress="return changeTab('ipd3',event)" />
        <input type="text" id="ipd4" onkeypress="return changeTab('ipd4',event)" /></br>
        <label>Destination IP Address</label>
    </div>
 
    <div id="inputMASK">
        <input type="text" id="MaskId_Dest" onkeypress="return RemoveDots('MaskId_Dest',event)"/></br>
        <label>Destination IP Prefix</label>
    </div>
 

<div align="left" style  = "width: 100%; height: 25%; margin-top: 0.9%;">

<p><b>Please select the Zones pair to allow the new traffic flow.</b></p>

    <table id="FW_Policy" align="left" style  = "width: 100%; backbround-color: white; margin-bottom: 0.9%;">   

        <tr><td><input type='radio' id="choices1" name='choices' value='LAN to DMZ' style ="margin-right:0.5%;">
            <label>  LAN to DMZ</label></td></tr>
        <tr class="alt"><td><input type='radio' id="choices2" name='choices' value='WAN to DMZ' style ="margin-right:0.5%;">
            <label>  WAN to DMZ</label></td></tr>
        <tr><td><input type='radio' name='choices' id="choices3" value='DMZ to LAN' style ="margin-right:0.5%;">
            <label>  DMZ to LAN</label></td></tr>
        <tr class="alt"><td><input type='radio' id="choices4" name='choices' value='DMZ to WAN' style ="margin-right:0.5%;">
            <label>  DMZ to WAN</label></td></tr>
        <tr><td><input type='radio' name='choices' id="choices5" value='WAN to LAN' style ="margin-right:0.5%;">
            <label>  WAN to LAN</label></td></tr>
        <tr class="alt"><td><input type='radio' id="choices6" name='choices' value='LAN to WAN' style ="margin-right:0.5%;">
            <label>  LAN to WAN</label></td></tr>
 
    </table>

</div>
 


<div> 

<p><b>Please select Layer 4 protocol, ICMP, ICC_FW_EXTENDED_TIMEOUT or ICC_FW_UUID_EXTENSIONS.</b></p>

    <form><b>
        <input type="radio" id="protocolID1" name='protocolID' value='TCP' style ="margin-right:0.5%;"> TCP
        <br>
        <input type="radio" id="protocolID2" name='protocolID' value='UDP' style ="margin-right:0.5%;"> UDP
        <br>
        <input type="radio" id="protocolID3" name='protocolID' value='ICMP' style ="margin-right:0.5%;"> ICMP
        <br>
        <input type="radio" id="protocolID5" name='protocolID' value='ICC_FW_UUID_EXTENSIONS' style ="margin-right:0.5%;"> ICC_FW_UUID_EXTENSIONS
        <br>
        <input type="radio" id="protocolID4" name='protocolID' value='ICC_FW_EXTENDED_TIMEOUT' style ="margin-right:0.5%;"> ICC_FW_EXTENDED_TIMEOUT
                        
    </b></form>

</div>
 


<div id="TCP_URP_Port" style  = "margin-top: 0.5%;">

<p><b>Please enter Layer 4 protocol port. In case of ICMP no port information is used.</b></p>

<table>
    
    <tr>
        <td style  = "width: 10%;">
            <input type="radio" id="WhatTCPorUDPPort1" name='PolicyPortsCh' value='any' style ="margin-right:0.5%;">
                <label><b>All [1-65535]</b></label>
        </td>
    </tr>



    <tr>
        <td style  = "width: 10%;">
            <input type="radio" id="WhatTCPorUDPPort2" name='PolicyPortsCh' value='Specific' style ="margin-right:0.5%;">
                <label><b>Specific</b></label> </td>

        <td><input type="text" id="portId" onkeypress="return RemoveDots('portId',event)"/></td>
      
    </tr>


    <tr>
        <td style  = "width: 10%;">
            <input type="radio" id="WhatTCPorUDPPort3" name='PolicyPortsCh' value='Range' style ="margin-right:0.5%;">
                <label><b>Range</b></label>
                    <label style ="margin-left:10%;">From port:</label>
        </td>

        <td><input type="text" id="PortRangeid1" onkeypress="return RemoveDots('PortRangeid1',event)"/>
            <label style ="margin-left:0.5%;">To port:</label>
                <input type="text" id="PortRangeid2" onkeypress="return RemoveDots('PortRangeid2',event)"/></td>
        </td>
    </tr>

</table>    
</div>



<div style  = "margin-top: 0.9%;">
    <p><b>Please select Policy action.</b></p>
    <form>
        <input type="radio" id ='PolicyAction1' name='PolicyAction' value='permit'> Allow
        <br>
        <input type="radio" id ='PolicyAction2' name='PolicyAction' value='reject'> Deny
    </form>
</div>



<div style  = "margin-top: 0.9%;">
    <p><b>Please select Fusion PE to apply the new policy.</b></p>

    <select id="FW_ID_Policy"; style="text-align: center";>
                <option value="">Fusion PE</option></select>
</div>

</br></br> 


<button type="button" onclick="CreatePolicy()" id = "Configure_Policy_button">Create Policy</button>
 
</br></br></br> 

</div>




<div id="Configure_Interface" class="tab-pane fade" style ="margin-left: 25px;">

</br>
</br>

<p><b>Please select zone to configure new IP Address.</b></p>
<form>
<input type="radio" name='ZoneID' value='LAN' checked = 'true'> LAN 
<br>
<input type="radio" name='ZoneID' value='DMZ'> DMZ
<br>
</form>


<br>
<p><b>Please select VLAN number to configure new IP Address. This must be between 2 and 1,000.
</b></p>

<input type="text" value='Unset' id="VLANnumber" onkeypress="return RemoveDots('VLANnumber',event)"/>

</br>
</br>


<p><b>Please enter new IP Address. Illegal IP addresses, as for example 127../x, 0../x, or 255../x, will be<br>
   rejected. </br>
   The new subnet will be re-distributed throughout your VPN. If this is a more specific subnet, it will be<br>
   preferred over existing routes. Please ensure you understand the routing impact to your network.</b>
</p>

<div id="inputIP">
        <input type="text" id="INTip1" onkeypress="return changeTab('INTip1',event)" />
        <input type="text" id="INTip2" onkeypress="return changeTab('INTip2',event)" />
        <input type="text" id="INTip3" onkeypress="return changeTab('INTip3',event)" />
        <input type="text" id="INTip4" onkeypress="return changeTab('INTip4',event)" /> </br>
        <label>IP Address</label>
    </div>

<div id="MASK">
    <input type="text" id="INTMaskId" onkeypress="return RemoveDots('INTMaskId',event)"/></br>
    <label>IP Prefix</label>
</div>


</br>

<p><b>Please select Fusion PE to apply configuration on.</b></p> 

<select id="FW_ID_Interface"; style="text-align: center";>
            <option value="">Fusion PE</option></select>

<br></br> 

<button type="button" onclick="GetInterfacesIP_Address()" id = "Configure_IP_Address_button">Apply IP address</button>

</div>



<div id="DHCP" class="tab-pane fade" style ="margin-left: 25px;">

<br>
<p><b>Please select zone to activate DHCP.</b></p>
<form>
<input type="radio" name='ZoneIDDHCP' value='LAN' checked = 'true'> LAN 
<br>
<input type="radio" name='ZoneIDDHCP' value='DMZ'> DMZ
</br>
</form>


<br>
<p><b>Please select VLAN number to activate the DHCP servce. This must be between 2 and 11.</b></p>  
<input type="text" value='Unset' id="DHCPVLANnumber" onkeypress="return RemoveDots('DHCPVLANnumber',event)"/>
</br>


<br>
<p><b>Please enter the DHCP Pool  This must be the subnet, or network, address, followed by the DHCP prefix.</b></p> 
<p style="color:#cc3300;"><b>The pool must be within the subnet of the interface-VLAN IP address, 
    on which DHCP is activated.</b></p>
<p><b>The DHCP pool prefix must be lower than 30 and equal to or greater than the Interface IP address.</b></p>

<div id="inputDHCP_Pool">
    <input type="text" id="ipDHCP_Pool1" onkeypress="return changeTab('ipDHCP_Pool1',event)" />
    <input type="text" id="ipDHCP_Pool2" onkeypress="return changeTab('ipDHCP_Pool2',event)" />
    <input type="text" id="ipDHCP_Pool3" onkeypress="return changeTab('ipDHCP_Pool3',event)" />
    <input type="text" id="ipDHCP_Pool4" onkeypress="return changeTab('ipDHCP_Pool4',event)" /></br>
    <label>DHCP Pool IP Subnet Address</label>
    </div>
</br>

<div id="MASK">
    <input type="text" id="DHCPMaskId" onkeypress="return RemoveDots('DHCPMaskId',event)"/></br>
    <label>DHCP Pool Prefix</label></br></br></br>
</div>



<p><b>Please enter first and last IP addresses from the DHCP Pool Subnet that can be assigned to
<br>DHCP clients.</b>

<div id="inputDHCP_First">
    <input type="text" id="ipDHCP_First1" onkeypress="return changeTab('ipDHCP_First1',event)" />
    <input type="text" id="ipDHCP_First2" onkeypress="return changeTab('ipDHCP_First2',event)" />
    <input type="text" id="ipDHCP_First3" onkeypress="return changeTab('ipDHCP_First3',event)" />
    <input type="text" id="ipDHCP_First4" onkeypress="return changeTab('ipDHCP_First4',event)" /> </br>
    <label>First Assignable DHCP IP Address</label>
</div>

</br>

<div id="inputDHCP_Last">
    <input type="text" id="ipDHCP_Last1" onkeypress="return changeTab('ipDHCP_Last1',event)" />
    <input type="text" id="ipDHCP_Last2" onkeypress="return changeTab('ipDHCP_Last2',event)" />
    <input type="text" id="ipDHCP_Last3" onkeypress="return changeTab('ipDHCP_Last3',event)" />
    <input type="text" id="ipDHCP_Last4" onkeypress="return changeTab('ipDHCP_Last4',event)" /> </br>
    <label>Last Assignable DHCP IP Address</label>
</div>



</br>



<p><b>Please enter the IP address of the Default Gateway.</b></p>

<div id="inputDHCP_DG">
    <input type="text" id="ipDHCP_DG1" onkeypress="return changeTab('ipDHCP_DG1',event)" />
    <input type="text" id="ipDHCP_DG2" onkeypress="return changeTab('ipDHCP_DG2',event)" />
    <input type="text" id="ipDHCP_DG3" onkeypress="return changeTab('ipDHCP_DG3',event)" />
    <input type="text" id="ipDHCP_DG4" onkeypress="return changeTab('ipDHCP_DG4',event)" /> </br>
    <label>Default Gateway for DHCP clients</label>
</div>



</br>



<p><b>Please enter DNS IP Address.</b></p>


<div id="DHCP_DNS">
    <input type="text" id="ipDHCP_DNS1" onkeypress="return changeTab('ipDHCP_DNS1',event)"/>
    <input type="text" id="ipDHCP_DNS2" onkeypress="return changeTab('ipDHCP_DNS2',event)"/>
    <input type="text" id="ipDHCP_DNS3" onkeypress="return changeTab('ipDHCP_DNS3',event)"/>
    <input type="text" id="ipDHCP_DNS4" onkeypress="return changeTab('ipDHCP_DNS4',event)"/>
    </br>
</div>

<label>DNS for DHCP clients</label><br/>

<!--    <button type="button" style ="visibility: hidden;" onclick="CreateDNSEntry()">Add DNS server</button>   -->


<br>
<p><b>Please select Fusion PE to apply configuration on.</b></p>

<select id="FW_ID_DHCP"; style="text-align: center";>
            <option value="">Fusion PE</option></select>


</br> 
</br>


<button type="button" onclick="GetInterfacesDHCP()" id = "Configure_DHCP_button">Apply DHCP Configuration</button>
</br>

<div><input type="text" value = 0 id="HoldZone" style ="visibility: hidden;"/></br>

</div>
</br>

</div>




<div id="Static_Route" class="tab-pane fade" style ="margin-left: 25px;">

</br>

<p><b>Please enter the network address, subnet mask and next hop for your new static route. Please </br>
      note:<br></br>

        - The static route prefix and mask must follow standard subneting practices, as per RFC 1878.</br>
        - Illegal route subnets, or next-hop values, as for example 127../x, 0../x, or 255../x, will be</br>
          rejected.</br> 
        - The next-hop IP address must be present in the routing table, for the static route to be</br>
          activated.</br>
        - Static routes have higher preference in the routing engine of your Fusion PE and will be</br>
          preferred over routes learned dynamically,</br>
        - Entering a more specific route than the route(s) currently used by your ICC Firewall will</br>
          result in the new route being preferred.</br>
        - The new subnet will be re-distributed throughout the VPN. If this is a more specific subnet, it </br>
          will be preferred over existing routes. Please ensure you understand the routing impact to the </br>
          network.</br>

</b></p>

</br>

<div id="StaticRouteSubnet">
    <input type="text" id="ipStaticRouteSubnet1" onkeypress="return changeTab('ipStaticRouteSubnet1',event)" />
    <input type="text" id="ipStaticRouteSubnet2" onkeypress="return changeTab('ipStaticRouteSubnet2',event)" />
    <input type="text" id="ipStaticRouteSubnet3" onkeypress="return changeTab('ipStaticRouteSubnet3',event)" />
    <input type="text" id="ipStaticRouteSubnet4" onkeypress="return changeTab('ipStaticRouteSubnet4',event)" /></br>
    <label>Static Route IP Subnet Network Address</label>
    </div>
</br>

<div id="StaticRouteMASK">
    <input type="text" id="StaticRouteMASKId" onkeypress="return RemoveDots('StaticRouteMASKId',event)"/></br>
    <label>Static Route IP Subnet Mask</label></br>
</div>


<div id="StaticRouteNextHop">
    <input type="text" id="ipStaticRouteNextHop1" onkeypress="return changeTab('ipStaticRouteNextHop1',event)" />
    <input type="text" id="ipStaticRouteNextHop2" onkeypress="return changeTab('ipStaticRouteNextHop2',event)" />
    <input type="text" id="ipStaticRouteNextHop3" onkeypress="return changeTab('ipStaticRouteNextHop3',event)" />
    <input type="text" id="ipStaticRouteNextHop4" onkeypress="return changeTab('ipStaticRouteNextHop4',event)" /></br>
    <label>Static Route IP Next Hop</label>
</div>


</br></br>


<p><b>Please select Fusion PE to apply configuration on.</b></p>

<select id="FW_ID_StaticRoute"; style="text-align: center";>
            <option value="">Fusion PE</option></select>
 
</br></br>

<button type="button" onclick="ApplyStaticRoute()" id = "Apply_Static_Route_button">Apply Static Route</button>

</div>



<div id="Rename_Device" class="tab-pane fade" style ="margin-left: 25px;">

<div id="Rename_Device_Text" style ="margin-top:20px; margin-left:50px;">

</br>

<p><b>The user is invited to replace the Fusion PE Hostname values in the drop-down
      menus of this tool,</br> with friendly names as per their personal preference.</br></br>

      This re-naming only refers to the scope of this tool. No configuration is applied to the
      actual Fusion PEs.</br></br>

		</br></p></b>

</br></br>

</div>



<div style ="width: 1260px; margin-top:10px; margin-left:25px; margin-right:2px;">

<table>
<tr>

    <td>
        <table style="width: 1100px;">
            <tbody>
                <tr>
                    <td><table id="Rename_Device_Table" style ="width: 1000px; margin-left:25px;"></table></td>
                </tr>
            </tbody>
        </table>
    </td>
    
    <td style = "vertical-align: top; text-align: left; width: 150px;";>
        <div style ="margin-top:20px;">
        <button type="button" onclick="Rename_Device()" id = "Rename_Device_button">Rename Device</button>
        </div>
    </td>

</tr>
</table>


</div>



</div>


</div>

<footer style ="position:fixed; bottom:0px; text-align: right;">
    <b>Copyright O2 UK</b><span style="padding-left:42%;"></span><span id="clock">&nbsp;</span>            
</footer>


</body>
</html>
